var i18n={setLanguage:function(t,n,e){return i18n.language=e,i18n.defaultLang=n||"en",i18n.supported=t||["en"],this},init:function(t,n,e){t=t||"resources/",n=n||"locale_",e=e||".json";var i=function(t,n){var e=window.navigator.userLanguage||window.navigator.language;return e=e.length>2?e.split("-")[0]:e,t.indexOf(e)>-1?e:n},a=function(t,n){if(null==t)try{JSON.parse(n.responseText),i18n._fail("Content is not defined")}catch(e){i18n._fail("Failed to parse the content",e)}else i18n.strings=t,i18n.localize()},r=pegasus(t+n+(i18n.language||i(i18n.supported,i18n.defaultLang))+e);r.then(a,i18n._fail)},_fail:function(t){console.error("[I18N]:"+t)},_jsonWalker:function(t,n){var e=n.split(".");return n=e.shift(),void 0==t||void 0==t[n]?(e.splice(0,0,n),"~~"+e.join(".")+"~~"):"object"==typeof t[n]&&e.length>0?this._jsonWalker(t[n],e.join(".")):t[n]},_isStringLocalized:function(t){function n(t){return("@"!==t[0]||"@"!==t[t.length-1])&&(/\s/.test(t)||t.indexOf("..")>-1||t.split(".").length<3)}return!t&&n(t)},localize:function(){if(!i18n.strings)throw"You must call the init method first";var t=function(t,n){if(n)try{n=n.replace("{",'{"').replace(":",'":').replace("}","}").replace(":'",':"').replace("'}",'"}'),n=JSON.parse(n)}catch(e){i18n._fail("Fail to parse context for "+t,e)}var i=libTranslate.getTranslationFunction({string:i18n._jsonWalker(i18n.strings,t.trim())});return i("string",void 0!=n?n:{})},n=function(n){if(n.indexOf("|i18n")>-1){var e=n.split("|");n=t(e[0],e.length>1?e[2]:null)}return n};Array.prototype.slice.call(document.getElementsByTagName("i18n")).map(function(n){i18n._isStringLocalized(n.textContent)||(n.textContent=t(n.textContent,n.attributes.context?n.attributes.context.value:null))}),Array.prototype.slice.call(document.getElementsByTagName("input")).map(function(t){t.placeholder=n(t.placeholder)}),Array.prototype.slice.call(document.getElementsByTagName("img")).map(function(t){t.alt=n(t.alt)}),Array.prototype.slice.call(document.getElementsByTagName("img")).map(function(t){t.title=n(t.title)})}};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});